pipeline {
  
	    agent any
         
           tools {
                 maven "3.8.6"
                }
            

                 stages {


	            stage ('Build') {
	                steps {
                              dir("cidr_convert_api/java/cidr-api"){

                               script{                   
                               sh 'mvn -B -DskipTests clean package'
                                 }
                                  }
                          }
			         
	                }
	            
                       stage ('SonarCloud Analysis') {
                     steps {
                        dir("cidr_convert_api/java/cidr-api"){ 
                        withSonarQubeEnv('SonarCloud') {
                          sh 'mvn org.sonarsource.scanner.maven:sonar-maven-plugin:3.7.0.1746:sonar '
                          }
                      }
                     }
                  }
			 
			 
                  stage('Testing'){ 
			 steps {
                        dir("cidr_convert_api/java/cidr-api"){

                      sh 'mvn test' 
           sh 'cd src/ ; java -jar ../lib/junit-platform-console-standalone-1.7.0-all.jar -cp "." --select-class CarTest --reports-dir="reports"'
                      junit '**/target/surefire-reports/TEST-*.xml'

                           }

		    }
                  }        
			
                        
	            stage ('Create docker image') {
	                steps {
	                 echo "creando dockerrrrrrrr"
	                }
	

	            }
	        }
	}
